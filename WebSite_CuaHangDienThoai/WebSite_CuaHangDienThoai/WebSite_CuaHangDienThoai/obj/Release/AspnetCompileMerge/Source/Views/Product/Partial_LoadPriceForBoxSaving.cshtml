
@model WebSite_CuaHangDienThoai.Models.tb_ProductDetail

@functions {
    // Hàm tính phần trăm giảm giá
    public decimal CalculateDiscountPercentage(decimal originalPrice, decimal salePrice)
    {
        if (originalPrice == 0 || salePrice >= originalPrice)
        {
            return 0; // Trả về 0 nếu giá gốc bằng 0 hoặc giá bán lớn hơn hoặc bằng giá gốc
        }

        decimal discount = 1 - (salePrice / originalPrice);
        return discount * 100;
    }
}
@if (ViewBag.item != null)
{
    <div class="">
        <div class="bs_title" style="  ">
            <div class="bs_price " style="color:white">
                @if (Model.PriceSale > 0)
                {
                    <div class="bs_price">
                        <b>Online Giá Rẻ Quá</b>
                        <strong> @WebSite_CuaHangDienThoai.Common.Common.FormatNumber(Model.PriceSale)đ</strong>
                        <em>  @WebSite_CuaHangDienThoai.Common.Common.FormatNumber(Model.Price)đ</em>
                        @{
                            decimal originalPrice = Convert.ToDecimal(Model.Price);
                            decimal salePrice = Convert.ToDecimal(Model.PriceSale);
                            decimal discountPercentage = CalculateDiscountPercentage(originalPrice, salePrice);
                        }
                        @if (discountPercentage > 0)
                        {

                            <i>(-@discountPercentage.ToString("0")%)</i>
                        }
                    </div>

                }
                else
                {
                    <div class="bs_price">
                        <b>Online Giá Rẻ Quá</b>
                        <strong>  @WebSite_CuaHangDienThoai.Common.Common.FormatNumber(Model.Price)đ</strong>

                    </div>
                }



            </div>
            <div class="bs_time " style=" flex: 0;  text-align: right; color: white ">
                <span>Kết thúc sau</span>
                <div id="clock_oltk" class="clockv2" data-time="2024/04/30 23:00:00" data-reload="1">
                    <b>09</b><i>:</i><b>15</b><i>:</i><b>44</b>
                </div>
            </div>
        </div>
        <div class="bs_content">
            <div class="block__promo">
                <div class="pr-top">
                    <p class="pr-txtb">Khuyến mãi </p>
                    <i class="pr-txt">Giá và khuyến mãi có thể kết thúc sớm hơn dự kiến</i>
                </div>
                <div class="pr-content">
                    <div class="pr-item">
                        <div class="divb t1" data-promotion="2323153" data-group="WebNote" data-discount="0" data-productcode="" data-tovalue="20">
                            <span class="nb">1</span>
                            <div class="divb-right ml-4">
                                <p>Nhập mã VNPAYLTD2 giảm ngay 1% (tối đa 200.000đ) khi thanh toán qua VNPAY-QR, áp dụng cho đơn hàng từ 3 Triệu <a href="https://www.thegioididong.com/tin-tuc/nhap-ma-vnpaytgdd2-se-duoc-tang-toi-da-200k-khi-thanh-toan-qua-vnpay-1563666" target="_blank">(Xem chi tiết tại đây)</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bs_rule">
                <ul style="list-style: none; display: block; list-style-type: disc; margin-block-start: 1em; margin-block-end: 1em; margin-inline-start: 0px; margin-inline-end: 0px; padding-inline-start: 40px; unicode-bidi: isolate; ">
                    <li>Giao hàng nhanh chóng (tuỳ khu vực).</li>
                    <li>Mỗi số điện thoại chỉ mua 1 sản phẩm trong 1 tháng.</li>
                    <li>Giá và khuyến mãi có thể kết thúc sớm.</li>
                </ul>
            </div>
            @*dia chi giao hang*@
            <div id="status-delivery" class="ml-3">
                <script>
                    var dataDeli = {};
                    dataDeli.ProductId = 305659;
                    dataDeli.ProductCode = "";
                    dataDeli.ProvinceId = 3;
                    dataDeli.ProvinceName = "H&#x1ED3; Ch&#xED; Minh";
                    dataDeli.DistrictId = 0;
                    dataDeli.DistrictName = "";
                    dataDeli.WardId = 0;
                    dataDeli.WardName = "";
                    dataDeli.Address = "";
                    dataDeli.IsCheckSubmit = true;
                </script>

                <div id="thoi-gian-giao-hang" class="xtoydays rslt none">
                    <div class="quickdelivery ">
                        <div class="deliverytime">
                            <p>
                                <a href="javascript:" onclick="OpenLocation(true)" class="onoffdelibox unline">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-geo-alt" viewBox="0 0 16 16">
                                        <path d="M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A32 32 0 0 1 8 14.58a32 32 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10" />
                                        <path d="M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4m0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6" />
                                    </svg>Chọn địa chỉ nhận hàng
                                </a> để biết thời gian giao.
                            </p>
                        </div>
                    </div>
                </div>
                <script>
                    setTimeout(function () {
                        document.querySelectorAll(".block-button").forEach(function (item) {
                            item.classList.remove('hide');
                        });
                        document.querySelectorAll(".isshowdelivery").forEach(function (item) {
                            item.classList.remove('hide');
                        });
                        document.querySelectorAll(".campaign>div>div>a").forEach(function (item) {
                            item.classList.remove('hide');
                        });
                    }, 100);
                </script>
            </div>

            @*btn gia tien*@

            <div class="block-button twoprice">
                @if (Model.PriceSale > 0)
                {
                    <a href="javascript:void(0);" class="btn-buynow red jsBuy twoprice btnAddtoCart" data-id="@Model.ProductDetailId" data-Color="@Model.Color">
                        MUA NGAY GIÁ RẺ QUÁ @WebSite_CuaHangDienThoai.Common.Common.FormatNumber(Model.PriceSale)₫
                    </a>
                }

                else
                {
                    <a href="javascript:void(0);" class="btn-buynow red jsBuy twoprice btnAddtoCart"  data-id="@Model.ProductDetailId" data-Color="@Model.Color">
                        MUA NGAY GIÁ @WebSite_CuaHangDienThoai.Common.Common.FormatNumber(Model.Price)₫
                    </a>

                }


                <a href="/tra-gop/tai-chinh/dtdd/iphone-15-pro-max-512gb?gtype=online2gia&amp;productCode=0131491003841" data-url="/tra-gop/tai-chinh/dtdd/iphone-15-pro-max-512gb?gtype=online2gia&amp;productCode=0131491003841" class="btn-ins pay-taichinh btn-left    ">
                    MUA TRẢ GÓP
                    <span>Duyệt hồ sơ trong 5 phút</span>
                </a>
                <a href="/tra-gop/the/dtdd/iphone-15-pro-max-512gb?gtype=online2gia&amp;productCode=0131491003841" data-url="/tra-gop/the/dtdd/iphone-15-pro-max-512gb?gtype=online2gia&amp;productCode=0131491003841" class="btn-ins btn-right pay-nganluong    ">
                    TRẢ GÓP 0% QUA THẺ
                    <span>Visa, Mastercard, JCB, Amex</span>
                </a>
            </div>
            @*end btn gia tien*@
            <p class="callorder">
                Gọi đặt mua <a href="tel:0329867771">0329867771</a> (7:30 - 22:00)
            </p>
        </div>

    </div>
}
else
{
    <p class="text-danger">
        Không tồn tại bảng ghi !!!
    </p>
}

<script>
   
</script>