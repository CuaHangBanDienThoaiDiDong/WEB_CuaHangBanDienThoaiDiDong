
@{
    ViewBag.Title = "Quản lý khách hàng";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";

}
@section naviheader{
    <!-- Left navbar links -->
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
        </li>
        <li class="nav-item d-none d-sm-inline-block">
            <a href="/admin" class="nav-link">Trang chủ</a>
        </li>
        <li class="nav-item d-none d-sm-inline-block">
            <a href="/admin/category" class="nav-link">@ViewBag.Title</a>
        </li>
    </ul>
}

<link href="~/Content/CSS/Admin/AccountClient.css" rel="stylesheet" />
<link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
<!-- Content Header (Page header) -->
<section class="content-header">
    <div class="container-fluid">
        <div class="row mb-2">
            <div class="col-sm-6">
                <h1>Quản lý khách hàng</h1>
            </div>
            <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                    <li class="breadcrumb-item"><a href="#">Home</a></li>
                    <li class="breadcrumb-item active">@ViewBag.Title</li>
                </ol>
            </div>
        </div>
    </div><!-- /.container-fluid -->
</section>

<section class="content">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Danh sách @ViewBag.Title</h3>
            <br />
            <span><label>Tổng số tài khoản khách hàng:</label> @ViewBag.Count</span>
            <div class="card-tools">
                <a href="/admin/products/add" class="btn btn-primary">Thêm mới</a>
                <a href="#" class="btn btn-danger" id="BtnDeleteAll">Xóa</a>
            </div>

        </div>
        <div class="card-body">
            @if (ViewBag.Count != null)
            {
                <div id="loadListCustomer">
                    @Html.Action("Partail_Index", "AccountClient")
                </div>
            }
            else
            {
                <p class="text-danger"></p>
            }
        </div>
        <div class="card-footer">

        </div>
    </div>
</section>

@section scripts{
    <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
    <script>
        $(document).ready(function () {
            LoadListCustomer();
            $('body').on('change', '#SelectAll', function () {
                var checkStatus = this.checked;
                var checkbox = $(this).parents('.card-body').find('tr td input:checkbox');
                checkbox.each(function () {
                    this.checked = checkStatus;
                    if (this.checked) {
                        checkbox.attr('selected', 'checked');
                    } else {
                        checkbox.attr('selected', '');
                    }
                });
            });

            $('body').on('click', '.btnClock', function () {
                var id = $(this).data("id");    Swal.fire({
                    title: "Bạn muốn khóa tài khoản này ?",
                    text: "Bạn đang thao tác !",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#3085d6",
                    cancelButtonColor: "#d33",
                    confirmButtonText: "Chắc, khóa!"
                }).then((result) => {
                    if (result.isConfirmed) {

                        $.ajax({
                            url: '/admin/AccountClient/IsLock',
                            type: 'POST',
                            data: { id: id },
                            success: function (rs) {
                                if (rs.success) {
                                    if (rs.Clock) {

                                        location.reload(true);
                                        btn.html("<i class=\"fas fa-lock\"></i>");
                                    }
                                    else {
                                        location.reload(true);
                                        btn.html("<i class=\"fas fa-lock-open\"></i>");

                                    }
                                }
                                 Swal.fire({
                                    title: "Khóa tài khoản thành công!",
                                  /*  text: "Your file has been deleted.",*/
                                    icon: "success"
                                });
                            }
                        });
                       
                    }
                });
                //var conf = confirm('Bạn có muốn khóa tài khoản này');
                //if (conf === true) {
                //    $.ajax({
                //        url: '/admin/AccountClient/IsLock',
                //        type: 'POST',
                //        data: { id: id },
                //        success: function (rs) {
                //            if (rs.success) {
                //                if (rs.Clock) {

                //                    location.reload(true);
                //                    btn.html("<i class=\"fas fa-lock\"></i>");
                //                }
                //                else {
                //                    location.reload(true);
                //                    btn.html("<i class=\"fas fa-lock-open\"></i>");

                //                }
                //            }
                //        }
                //    });
                //}
            });
        });



        function LoadListCustomer() {

            $.ajax({
                url: '/admin/AccountClient/Partail_View',
                type: 'GET',
             
                success: function (rs) {
                    $('#loadListCustomer').html(rs.Count);
                },
                error: function (error) {
                    console.log(error);
                }
            });
        }
    </script>

}




