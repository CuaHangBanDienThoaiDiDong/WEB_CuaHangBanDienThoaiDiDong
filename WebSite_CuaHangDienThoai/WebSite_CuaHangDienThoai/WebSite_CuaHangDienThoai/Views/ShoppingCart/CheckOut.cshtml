
@{
    ViewBag.Title = "Thanh toán";
    Layout = "~/Views/Shared/_LayoutPage.cshtml";
}


<style>
    .error {
        color: red;
    }
</style>

<link rel="stylesheet" type="text/css" href="~/Content/assets/styles/categories_styles.css">
<link rel="stylesheet" type="text/css" href="~/Content/assets/styles/categories_responsive.css">
<br />
<br />
<br />
<br />
<br />
<br />
<br />


<div class="container">
    <div class="row">
        <div class="col-lg-9 loadListProCheckOut">
            @Html.Action("Partial_ChiTietSanPhamMua", "ShoppingCart")
        </div>




        <div class="col-lg-3">
            @Html.Action("Partial_CheckOut", "ShoppingCart")
        </div>


    </div>
</div>
























<!--<div class="container ">
    <div class="row">
        <div class="col product_section clearfix">


            <div class="breadcrumbs d-flex flex-row align-items-center">
                <ul>
                    <li><a href="/Home/Index">Home</a></li>
                    <li class="active"><a href="/"><i class="fa fa-angle-right" aria-hidden="true"></i>Giỏ hàng</a></li>
                </ul>
            </div>


            if (ViewBag.Cart != null)
            {-->
                <!-- Main Content -->
                <!--<div class="row">

                    <div class="col-md-12 text-center">
                        <h1 class="">Thanh toán</h1>
                        <p>Bạn hãy kiểm tra lại thông tin đơn hàng cho chính xác!</p>
                    </div>

                </div>
                <hr />
                <div class="row">
                    <div class="col-md-6">
                        Html.Action("Partial_CheckOut", "ShoppingCart")
                        <hr />

                    </div>

                    <div class="col-md-6">

                        <div id="show_error" class="error"></div>
                    </div>
                </div>

            }
            else
            {
                <div>
                    Bạn chưa có sản phẩm nào. Vui long quay lại trang <a href="/Home/Index">sản phẩm</a> để mua hàng.
                </div>
            }
        </div>
    </div>
</div>-->

@section scripts{
    <!---SweetAlter-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.7/dist/sweetalert2.all.min.js"></script>
    <script src="~/Content/assets/js/categories_custom.js"></script>
    <script>
        function OnFailure(rs) {
            if (!rs.Success) {
                $('#show_success').html("Bạn mua hàng thất bại! Xin vui lòng thử lại");
            }
        }
        $(document).ready(function () {
            $('.TypePaymentVN').on('change', function () {
                // Nếu checkbox được chọn, hủy chọn tất cả các checkbox khác
                if ($(this).prop('checked')) {
                    $('.TypePaymentVN').not(this).prop('checked', false);
                }
            });
        });
        $(document).ready(function () {
            $('body').on('change', '#drTypePayment', function () {
                var type = $(this).val();
                $('#load_form_payment').hide();
                if (type == "2") {
                    $('#load_form_payment').show();
                }
            });
            //$('#myForm').validate({
            //    rules: {
            //        'CustomerName': {
            //            required: true
            //        },
            //        'Phone': {
            //            required: true
            //        },
            //        'Address': {
            //            required: true
            //        },
            //        'Email': {
            //            required: true,
            //            email: true
            //        }
            //    },
            //    messages: {
            //        'CustomerName': 'Bạn khổng để trống trường này',
            //        'Phone': 'Bạn khổng để trống trường này',
            //        'Address': 'Bạn khổng để trống trường này',
            //        'Email': 'Email chưa hợp lệ'
            //    }
            //});
        });





        $(document).ready(function () {
            LoadListProCheckOut();

            $(".btndeleteCheckOut").click(function (e) {
                e.preventDefault(); // Ngăn chặn hành động mặc định của thẻ <a>
                alert("RTHuan");
                // Lấy ProductDetailId từ thuộc tính dữ liệu (data)
                var productId = $(this).data("id");

                Swal.fire({
                    title: "Bạn có chắc?",
                    text: "Muốn xóa sản phẩn này!",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#3085d6",
                    cancelButtonColor: "#d33",
                    confirmButtonText: "Xóa !"
                }).then((result) => {
                    if (result.isConfirmed) {
                        $.ajax({
                            url: '/DeleteCartItem/DeleteCartItem',
                            type: 'POST',
                            data: { id: productId },
                            success: function (rs) {
                                if (rs.Success) {
                                    if (rs.Code == 1) {
                                        LoadListProCheckOut
                                        const Toast = Swal.mixin({
                                            toast: true,
                                            position: "top-end",
                                            showConfirmButton: false,
                                            timer: 3000,
                                            timerProgressBar: true,
                                            didOpen: (toast) => {
                                                toast.onmouseenter = Swal.stopTimer;
                                                toast.onmouseleave = Swal.resumeTimer;
                                            }
                                        });

                                        Toast.fire({
                                            icon: "success",
                                            title: "Xoá thành công"
                                        });
                                    }
                                }
                            }
                        });
                    }
                });

            });


        });

        function LoadListProCheckOut() {
            $.ajax({
                url: '/shoppingcart/Partial_ChiTietSanPhamMua',

                type: 'GET',
                success: function (rs) {
                    $('.loadListProCheckOut').html(rs);
                }
            });
        }





    </script>
}